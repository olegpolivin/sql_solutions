# 1
SELECT PC.model, PC.speed, PC.hd
FROM PC
WHERE PC.price < 500;

# 2
SELECT DISTINCT maker
FROM Product
WHERE type='Printer';

# 3
SELECT model, ram, screen
FROM Laptop
WHERE price > 1000

# 4
SELECT *
FROM Printer
WHERE color = 'y';

# 5
SELECT model, speed, hd
FROM PC
WHERE (cd = '12x' OR cd = '24x') AND price < 600;

# 6
SELECT DISTINCT maker, speed FROM
Product JOIN Laptop
ON Product.model = Laptop.model
WHERE hd>=10

# 7
with t as (
SELECT model, price FROM PC
UNION
SELECT model, price FROM Laptop
UNION
SELECT model, price FROM Printer),

producer_b as (
SELECT maker, model
FROM Product
WHERE maker = 'B')

SELECT t.model, price FROM
producer_b JOIN t
ON producer_b.model = t.model

# 8
SELECT maker
FROM Product
WHERE type in ('PC', 'Laptop')
EXCEPT
SELECT maker
FROM Product
WHERE type = 'Laptop'

# 9
SELECT DISTINCT maker
FROM Product
JOIN
(SELECT model
FROM PC
WHERE speed >= 450) Q
ON Product.model = Q.model

# 1O
SELECT model, price 
FROM Printer 
WHERE price = 
(SELECT MAX(price)
FROM Printer)

# 11
SELECT AVG(speed) as Avg_speed
FROM PC

# 12
SELECT AVG(speed) as Avg_speed
FROM Laptop
WHERE price > 1000

# 13
WITH T AS (
SELECT maker, model
FROM Product
WHERE maker = 'A')

SELECT AVG(speed)
FROM PC JOIN T
ON PC.model = T.model

# 14
SELECT Ships.class, Ships.name, country
FROM Ships JOIN Classes
ON Ships.class = Classes.class
WHERE Classes.numGuns >= 10

# 15
SELECT hd
FROM PC
GROUP BY hd
HAVING COUNT(*) >= 2

# 16
SELECT DISTINCT A.model as model, B.model as model, A.speed, A.ram
FROM PC as A, PC as B
WHERE A.model > B.model AND A.speed = B.speed AND A.ram = B.ram
ORDER BY A.model DESC, A.speed, A.ram

# 17
SELECT DISTINCT 'Laptop' as Type, model, speed
FROM Laptop
WHERE speed < ALL (SELECT speed FROM PC)

# 18
with query as
(SELECT model, price
FROM Printer
WHERE price = (SELECT MIN(price)
                           FROM Printer
                           WHERE color='y') AND color='y')
SELECT DISTINCT maker, price
FROM Product JOIN query
ON Product.model = query.model

# 19
SELECT maker, AVG(screen)
FROM Product JOIN Laptop 
ON Product.model = Laptop.model
GROUP BY maker

# 20
SELECT maker, COUNT(*)
FROM Product
GROUP BY maker, type
HAVING COUNT(*) >= 3 AND type = 'PC'

# 21
SELECT maker, MAX(Price) as Max_price
FROM PC JOIN Product
ON PC.model = Product.model
GROUP BY Product.maker

# 22
SELECT speed, AVG(price)
FROM PC
GROUP BY speed
HAVING speed > 600

# 23
SELECT maker
FROM Product JOIN PC
ON Product.model = PC.model
WHERE PC.speed >= 750
INTERSECT
SELECT maker
FROM Product JOIN Laptop
ON Product.model = Laptop.model
WHERE Laptop.speed >= 750

# 24
WITH Q AS (
SELECT model, PC.price
FROM PC
UNION
SELECT model, Laptop.price
FROM Laptop
UNION
SELECT model, Printer.price
FROM Printer
)

SELECT model
FROM Q
WHERE price = (SELECT MAX(price) FROM Q)

# 25
with MINRAM as (
SELECT model, speed
FROM PC
WHERE ram = (SELECT MIN(ram) FROM PC)),

MINRAMFAST as (
SELECT model
FROM MINRAM
WHERE speed = (SELECT MAX(speed) FROM MINRAM))

SELECT DISTINCT maker
FROM Product
WHERE type = 'Printer' and maker in ( SELECT maker
FROM Product JOIN MINRAMFAST
ON Product.model = MINRAMFAST.model)

# 26
with PCLAP AS (
SELECT model, price
FROM PC
UNION ALL
SELECT model, price
FROM Laptop)

SELECT AVG(price) as AVG_price
FROM Product JOIN PCLAP
ON Product.model = PCLAP.model
WHERE Product.maker = 'A'

# 27
with SUPERMAKER AS (
SELECT DISTINCT maker
FROM Product
WHERE type = 'PC'
INTERSECT
SELECT maker
FROM Product
WHERE type = 'Printer'),

PLAP AS (
SELECT maker, hd
FROM Product JOIN PC
ON Product.model = PC.model)

SELECT maker, AVG(hd) as Avg_hd
FROM PLAP
GROUP BY maker
HAVING maker in (SELECT maker FROM SUPERMAKER)

# 28
SELECT COUNT(*) AS Qty
FROM (SELECT maker
FROM Product
GROUP BY maker
HAVING COUNT(*) = 1) A

# 29
SELECT Income_o.point, Income_o.date, inc, out
FROM Income_o
LEFT JOIN Outcome_o
ON Income_o.date = Outcome_o.date AND income_o.point = outcome_o.point
UNION
SELECT Outcome_o.point, Outcome_o.date, inc, out
FROM Outcome_o
LEFT JOIN Income_o
ON Income_o.date = Outcome_o.date AND income_o.point = outcome_o.point

